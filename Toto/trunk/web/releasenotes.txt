18-01-21 3

More development of preprocessor - principally on handling of mapped headings, finding the heading line

18-01-21 2

Scale function optimisation

18-01-21

Some AQL syntax updates

Report scheduler updates

preprocessor upgrades e.g. progress logs

Small optimisation to scale, more to be done

09-12-20

Bug fixes for new risk agg

XLSX

All Risks A&S updated

02-12-20 2

Keikai license allocation adjusted

Another xls bug fixed for risk agg

Includes on the Import Wizard

23-11-20

R integration

Support for more than one headings line in the pre processor

Filterby improvements

Moved to Keikai

XLSX

Considerable import wizard supporting work for the new "generic" database

08-10-20

order auto backups list

05-10-20

A few bug fixes

Filterby without context

XLSX

Work on standardised database that can be used with the import wizard

15-09-20

plugin bug fix

07-09-20

Important bug fix relating to empty ECF files

03-09-20

Some initial code for AllRisks integrationau

Preprocessor adjustment : clears the input line between lines, so that values from last line do not persist. Also does not break when it finds a blank cell

sheetnamematches, another constraint for wespecialty

Import Wizard work

XLSX

OIlfield tweak, finishing wespecialy deduction problems

21-08-20

Wespecialty had a file that was jamming poi. Latest version fixed that, much of the importer moved to that, more can be tidied but the fix is required now

18-08-20

Various bug fixes

Admins can test user menus

Adjustments for wespecialty - handle duplicate headings better and files containing premiums and claims

XLSX

Considerable work building Oilfield and Wespeciality

AllRisks tweaks - what is there now does seem to submit on 0 grossamt claims

15-07-20-3

Import file template lookup bug fix

XLSX
i
Continue Oilfield Claims and WeSpeciality build

08-07-20

A few bug fixes - wespeciality

06-07-20-2

Bug fixes on the preprocessor, better error messages

Initial work on the users API

XLSX

Continue Oilfield Claims and WeSpeciality build

Allrisks Claims limnet currency to 002

30-06-20-3

New preprocessor bug fixes x 3

Download a summary of recent user activity.

XLSX

AllRisks Premium bug fix, Claims new tags in (GrossAmt 0 and Lloyds Lead)

Continue Oilfields Build

25-06-20

Augment auto backup to use a specified directory

code to handle 'categorisation on'

XLSX

Further building on Weber/Oilfields/Hanover

19-06-20

Further improvements to error messages

New Excel based preprocessor (input and output regions in a workbook) - will be used on TMK

XLSX

Premiums AllRisks, can override Settlement Due Date

Importer bug fix, complain properly about duff contract years (Premiums)

Finish previous Hanover work as reference

12-06-20

More work on tracking

Further improvements to compositionxl

Recent user activity downloadable

New error list shows at the top of the reports section if any errors occur

will accept 'az=' instead of 'compositionXL'. Will also be tolerant of no space after '='

if RepeatSheet set is empty, will not show the sheet

XLSX

Tracking stuff on AllRisks claims

Oilfields build continues

04-06-20

Compositexl tweaks

Can have an import version sheet without a model

Tracking Db initial version, needs more work

XLSX

T account totals on specify premium feed

Claims feed tweaks (Limnet currencies)

Oilfield currencies work

ECF fix - claims count on summary sheet

Tracking db. Importer and additions to Specify Claims feed

27-05-20

Track user activity in the database now

Zap libreoffice hack, it's not reliable. Error instead to the user.

Tweaks to compositionxl as it beginst to be used

Check for empty files attached to XML and if so don't send

Multi file upload

Importer tweak for managing T-account lookups

XLSX

T-account work in the lookups + premium feed, Brokaerage Account Suffix etc.

Oilfields previously paid

Small limnet adjustment :"If Outstanding Amount is zero, the Lloyds / ILU / LIRMA Qualifiers must be set to T (To Be Advised) or N (Nil) for each currency on the claim."

Claims, make it so trans desc can show Covid-19

Weber started in SVN

12-05-20

Hide automated uploads unless the user clicks to see them

Excel notation supported on composition. Use compositionxl

XLSX

Master Coastal Adjustments including commission

Lots of Oilfield work approaching initial Prod deployment

Make AllRisks Claims validation more tolerant of blank dates

Update AllRisks Claims Previously Paid

Lineage XML adjustments

Allrisks Claims Latest Fees and Latest Res adjustments

28-04-20

allow double spaces in the pending upload name ( still parse month etc under those circumstances)

Importer can try to lookup the version from the file name

XMl feed bug fix for over two deductions

XLSX

Various Master Coastal and OilFields work

21-04-20

Further importer work. Uploaded files list neatened.

XLSX

ASSliptype to be Binding Authority

BB304140 importer work

16-04-20

Various bug fixes and work on the importer for Oilfields and BB304140.

XLSX

AllRisks Limnet back inm

Previously paid added to AllRisks Claims

Lots of Oilfields work to get an initial set of correct figures

01-04-20

Bug fixing to error reporting and ignoring of carriage returns in headings

Option to switch off snap charts and a further bug fix to carriage returns in headings

Bug fix to importer cell interdependence resolution, for Claims Feb-20

XLSX

Linneage third deductions added

Risk Solutions setup - added entry for previously paid

"document" lower case on splits ASDocType also

Removed carriage return from Los Loc county on allriskclaim - relates to Java now ignoring the carriage returns on headings - added due to Claims Feb

19-03-20

Further importer tidying

Basic statistics recording - importer features initially

Bug fix on scale function

Move the sort arrows to the beginning of the column name

Temporary db copies are now just for that user

A little tidying and making the import version file heading matching ignores carriage returns

Claims Groovy : claims format change again, "totals for" doens't have the colon and the headings are at row 2 not 5. Hence the detect for "coverholder"

XLSX

AllRisks

Claims XML file case fixed (XML mixed case XLSX lower case)

Premium DedAccSub Change to DedSubNo

Claims changed paid to date expense to be change this month - fees.

Hanover

Linneage

removed ASDETAILS and ASDocType from the xml

DedAccSub Change to DedSubNo

Premium feed - Changed the rowgeadings to now correctly intersect with coverholder chosen

changed Deduction-2/DedPA to be 'A' and the DedPerc to be '0'

added feature to have multiple DedAccNo's

Swapped the DedAccSub's. So no 00 is against 70149 and 14 is against 99902

importing - Removed 'coverholder name' from the import. They will only come from the lookups now.

Added functionality for having contracts refered to in different ways B1191C190002 is BB308120n for example

Oilfields

deductions work

classification formatting

Changed premium template to add 'Commission Amount'

Swapped Policy commission % with net amount. Also added commision amount

03-03-20

BatchImporter being refactored, logic needed fixing. Some local testing done, need to keep an eye on it.

Improved showing of data in Inspect Database

Bug fix on "ad hoc" data regions. Shown up by oilfield testing

Fixed a bug when getting attributes for a cell. Oilfield.

Another formula result cache clear added. Oilfield.

XLSX

ASDocType Document -> document

Lots of Oilfield claims and premiums work including BSX integration

Brokasure, changed 'DedAppNo' in the xml tags to be 'DedAppCode'

Changed the `ECFDocType` to have 'document' in it with a lower case 'd'.

Linneage - Changed the DedAccSub to be 14 for the first deduction per Lukes instructions

20-02-20

Improved handling of calcs on import - oilfields

Force files attached to XML feed to lower case

XLSX

Premiums XML file name back to uppercase - the Java will make the attached files lower case

19-02-20

Scale function adjusted again for Jan Premiums

Clarifying import logic regarding initial values check, zapping a nasty pending upload config file counter bug on empty sheets!

XLSX

Jan-20 premiums work

18-02-20

Scale function adjusted for Jan Premiums

XLSX

More Hanover and Linneage work

14-02-20

Logging improvements a few bug fixes

New groovy for All Risks Premiums

XLSX

New premiums added to the import template

12-02-20

Work on name definitions

Various code changes to allow the new version of name to be switched in and out. Currently defaulting to the old version.

Support for configuring passworded zips/xlsx files. Last word on pending upload files zips is the password, on not pending add password to the file parameters e.g.
AllRisks claim oct-19 12&Ddfg.zip
AllRisks Risk Oct-19(importversion=allrisksrisk;month=Oct-19;password=12&Ddfg).zip

XLSX

Hanover - Added the validations for all of the Risk formats, not just HanoverRisk.

Linneage - Changes made to allow sending via Brokasure

First Linneage files.

07-02-20

More work on the new NameData structure

Zapping all "160 character"s when converting XLSX -> CSV. It's some kind of unusual space that isn't caught by .trim() and cases havok, I see no advantage in leaving it in. (Hanover)

XLSX

lower case the file name (e.g. pmdec12345.xlsx) on claims and premium feeds

Storage check - adjusted formula in N9 and to the right to refer to N7 rather than o7 to get loaded file name correct

Importer - Premiums now categorised by premium line

Adjusted the 'Reporting Category' on Risk and Claim from 'Policy Reference' to 'Policy Line' and 'Claim Reference'. The import sheet 'AllRisks classify' needed additional headings of Zip code and Address Line 1 to work.

This fix needed so as not to interfere with the Premium classification, which is now at Premium Policy Line level.

Premium feed changed suff to sub for the fees deductions per Lukes request

Various Hanover work in preparation for initial test

30-01-20

Calc bug fix

Don't resolve stacked headings when they're all there is in the file. Will reduce the chances of junk in the database

Take ed b branding off the debug, more work on the uploadreport.xlsx

28-01-20

initial version of file to re read the uploads back in with uploadreport.xlsx (automatically replicate the boxes ticked on pending upload)

Don't repeat display row and column headings if they're outside the repeat region. Initial test is fine though it may need more testing

Yet another attempt at POI hacking back in for Hanover decryption. This time by hacking out the line which breaks on decryption. Not pretty but it seems to work, has been on data.azquo.com for a week. Requires the OPenJDK upgrade.

XLSX

Rolling back Nov 28th XML patch on Premiums feed

adjusted the formula to stop the segregation of FL for the 'N' year

added 'provisional' to the premium county in the import model

Inserted a check for Brokasure reporting section errors and disabled the 'No SLA' error

21-01-20

POI back out! Some frustration as we try to make ZK and apache play ball

21-01-20

Latest POI back in, ZK version of xml beans zapped. Hanover decryption re-enabled if the JVM supports it.

20-01-20

Pending clear before upload - template parameter is pendingdataclear

XLSX

Hanover - Changed the commission formula to calculate by the correct number of decimal places

17-01-20

Match files from Brokasure back to their original database and initial decryption code for Hanover files

Default choices are slightly more robust

Zapped POI, reflection crossover, decryption broken again

XLSX

Changed the commission formula to calculate by the correct number of decimal places (Hanover)

First set of reports for Hanover.

16-01-20

XLSX

Section is now 'provisional' on the import model

15-01-20

Force JVM locale to UK to stop any date handling confusion on server side XLSX processing

added disk space warning

XLSX

Self storage - Filters current contract year only!

AllRisks Validations All Risks -> All Risks, LTD, I don't think it stopped it working but this is best practice

Split contracts workbook, Removed 'reportingmonth'

added 'county' to Premium imports

rename setup so its loaded first if in a zip. Perhaps not necessary but better safe than sorry

10-01-20

Azure authentication preparation

tidying, bug fix on presave provenance report name and preparatory work for new core memory db structures and possible Azure authentication

start at 2 million on the tracking db, don't load data for the last 10 years!

XLSX

Claims Feed - Changed how the contract year for the split sections is specified. It now uses a formula based on the split contract reporting section, not 'Brokasure Contract Year' in column G

20-12-19

Checked for database names of two letters or less - download backup bug

Hanover claim groovy added

Validation bug fix required for Hanover (converted from spreadsheet is always tab separated)

Charset fix on lines rejected
Preparation for Azure authentication

XLSX

Limnet not just off but XML tags removed for the moment

17-12-19

Adjustments to checkOnlyAndExisting to stop the "names being created by composite on a line that's then rejected bug"

Bug fix on auditing when that region is from a different database, don't scan tracking evey hour, make it every day

Bug fixes in the excel controller where there's one report. Lookup reports by name where the name has ampersand in it

12-12-19

Bug fix detecting import templates on upload and creating new users given new criteria that users can exist for more than one business

initial version of hanover permium groovy to sort the section and contract years

XLSX

Created Hanover directory

Limnet off for the mo on Allrisks

10-12-19

Bug fix on register business. Bug fix on new menu formatting.

New functionality where a user can be in more than one business so they then need to select a business on logging in.

executes 'presave' if that option exists

Zapping comparewith and fixing a nasty user/username swap on saving. Also sql patch preparing for one user being in multiple businesses

Bug thrown up by EL import - a bit more robust to integer formatted formulae

report list formatting stuff

'provisional' on condition checks only lasts to next check

A little tidying, zapping duff PDF option, add choices to downloaded reports' name

fix nasty bug that could stop the last line in a file being rejected during validation

Indent the admin reports list according to category

XLSX

new template for 'AllRisksClassify' replaces 'AllRisksSplitContracts'

Claims contract year categorisation -  Hid some lines, removed 'Month' from context, and changed choice from 'ReportingMonth' to 'Month'

Specified Claim County as 'language claim county'

Changed derivation of 'Policy Ref' on 'AllrisksPremiumSplitContracts'

Including many 'N' contracts in the All Risks list

Added a template to import BB304140 corrections

Premium - patch to XML structure (added PremiumTrans)

Self Storage - Moves categorisation from Policy Ref level to Policy Lines level, while also creating Liability Section 1 and checking 80-20 split.

Limnet - reverted back to the previous version - I had an old reference file. Limnet was correct. Or more correct anyway.

Plugin

Added new functionality for users that span more than one business. When inserting rows then insert the whole row, this will shift row formatting down (fixes hidden row bug on Specify claims feed to Broaksure)

22-11-19

If it's converted from a worksheet then it's *always* tab separated, if not then try to detect from the file - fixes problem with validation on 302860N premiums flagged yesterday,

XLSX

Add a (hidden) display row headings - will cause the total formatting to kick in

Added 'Y' to the limnet flag. Also all the old limnet headings were not in, so added them.

Adjusted Limnet xml tag names based off the spec

20-11-19

Claims V5 tweak to make formatting match the plugin (blue line totals)

19-11-19-2

XLSX

added fees data to the split sections

Risk agg - moved the 'states' vlookup so it work with the copes in both ZK and the plugin.

Tweaked column widths for formatting in the plugin

19-11-19

Stop empty duplicate tags on the xml feed

Fixed inconsistency on user/userName being used on provenance. Caused a false data lock that affected clear premium feed markers

Saving multiple regions plug in bug fixed

XLSX

Removed 'existing' form the import model for 'contract' it was not needed as there is an existing against contract year and it was making identifying other issues harder.

Specify premium - Hid a few columns to tidy it up.

Premium feed added fees data to split sections

16-11-19

Adjusted the 'checkCondition' routine so that it would return CHECKMAYBE.

CHECKMAYBE is returned when one or more conditions cannot be evaluated (there is no field to evaluate), but all other conditions are true.

if CHECKMAYBE is returned, a 'provisional' flag is set. If a subsequent test returns CHECKTRUE then the system will check whether this is an 'exclusive' categorisation, and, if so, will only set the value if there is not an existing value.

The net effect should be that such values are only set where there is full information to set them. This requirement originates in Allrisks categorisation of BB304140N, and BB304150N. Categorisation of BB304140N needs county information which is not in the premiums, but categorisation of BB304150N requires commission information which is not in the risk. Thus, in each case, the import with full information should be the defining import.

Note that, if both commission and county are required for a future import, we shall need some further thought!

Adjusted 'checkcondition' to allow for provisional conditions as well as provisional results!

15-11-19

az_options tolerant of scope

Fixed duplicate entries in the zip bug (was stopping a database backup)

XLSX

Included 'Fees' in Import Model and AllrisksPremium import versions

added totals to the bottom of the deductions columns

New import templates with all the unneeded buts for RT, Hannover, etc taken out. Also with greatly reduced 'import model' tab.

Premiums : Adjusted to allow commission % > 0 but < min percentage. Also adjusted parameters to refer to Contrac Year rather than Contract. Needs adjustment to import templates.

added 'Provisional' to Premium templates underwriter and reporting category. Changed postprocessor to remove REO and base commission calculations on contract year

Allrisks Premium templates - Reporting Category is parent of Policy Reference (not Premium Policy Line)

Fees added

Fixed issues in regards to scope and removed all references too and RT functionality

Deduction-2 is the syntax for multiple tags with the same name. Also zapping the split contract definitions, they are in teams

Removed references to 'All risks'

adjusted parameters for fees to Sophie's spec

set deductions always to be positive

14-11-19

Importing "existing" bug fixed

13-11-19

Java

Bug fix in pending uploads and more notify changes to ensure formulae are being recalculated as required. Might have performance issues but better safe than sorry

Bug fix when restoring just reports on a backup and bug fix to clear formula caches when setting choices on attached summaries for xml feeds. Also bug fix on report analysis.

Report analysis work and some tidying and bug fixing notably when saving a region with no row headings (one which will be converted to tsv for upload) there was a bug checking for the row headings name that didn't check for names in spreadsheet scope as well as outside it

Bug fix that affected the y -> sent

XLSX

Premiums - Corrected wrong Commission %, removed 'Value' from context meaning commissions % pulls through correctly,

Premiums - With 'Brokasure Percentage' as an attribute of the contract year or contract year reporting category

Specify Premiums - Shows the Brokasure Section, as well as the report section

Premium Feed - Removed spurious formula at top (=@az_XMLExtraInfoSplitSections), moved az_ColumnHeadingsSplitSections to relate to the data, changed the name of az_ChosenClaimsQuery to az_ChosenPremiumsQuery, and reformatted F21-F29

Claims Feed - Changed 3 values for the xml to be only to 2 decimal places. GrossAmt, LatestFee and LatestRes.

Claims - changed how report is specified so returned data from brokasure displays correctly when saved against UCR

Claims - changed az_ReportingMonthChoice and chosen to be simply az_Month. This is to stop the display at the top not matching the data.

Miscellaneous tidying (removing redundant names), zapped redundant files (about 10 of them)

Premium - column formatting

Premium Feed -  Includes Brokasure section and commission

Premium feed clear markers - cleaned up - removed old 'summary' data region, renamed 'zSummary', cleaned the formatting and hid columns

Premium Feed - including the 'deduction' subset - also cleaned up

Premium commission - calculates the commission as well as checking. Cleaned up

Premium BI export added back in, don't know where it went

05-11-19 -2

Under certain circumstances user choices were being lost in ZK. Fixed now.

Risk Aggregate Report - Options named range was incorrect, now there is az_OptionsSlipLines2 with the hide heading errors, Limit the month choice to start at Mar-14. THis stops date errors when selecting the earliest month

05-11-19

Bug fixes on permute headings, the filtersets were being reset on each load. Not now.

OPC package revert─ there should be no closes. And remove totally empty rows from the data sort function - it can interfere with other code

Premium Feed - Changed dates for SSDloyds and DueDate (Due date 3 months after effective, SSDLoyds then 14 days after that)

Self Storage Check - Hidecols set to 0 for the moment, it can't be set back to 1 until a Java patch has gone in. It was resulting in a single empty row which the Java wasn't ready for

Premium feed - reduced formula dependencies which seemed to be tripping ZK (missing last section on non splits fixed)

29-10-19

Bug fixes on possible file handler leaks

23-10-19

Remove validations from XML accompanying reports

22-10-19

BUg fix - Excel controller

22-10-19 - 2

Bug fix, tweaks for XML feed

21-10-19

Bug fix, tweaks for XML feed

small bugfix in 'scale' - include value names in parent list

Time to the second on provenance display, debug info on Excel save

do not assume strings if cells contain NULL

better error message

Correction when parameters (such as file names) have brackets within them

07-10-19

removed the quote marks which were put round names for ROWHEADING and COLUMNHEADING replacements

adjusted the routines for getting ROWHEADING and COLUMNHEADING replacements to return unqualified names where possible.

Tidying and adding the user comments to uploaded files

replaces user choices in repeat regions

A bit of tidying and the select all on validation checkboxes

23-09-19

Plugin bug fix on Claims V5 Bordereau

fixed bud on 'if' conditionals where interim values were stored in the cell

checks that there are files to download before trying to do so

Reduce the chances of "unknown" Provenance being set

will not show an exception if a 'for each' instruction cannot find the name

18-09-19

Adjusted the function 'pathcount' to accept [ROWHEADING] as second parameter.

Plugin : passable solution to edit mode problem - users are prompted. Have contacted MS for more details

16-09-19

More tracking columns added

uses 'category lookups' to enable serial classification to work with different import templates

checked that 'headingsForThisCell' has more than one element

will resolve compositions if necessary when evaluating lookups

08-09-19

Initial version of tracking database code for Ed Broking

Allow zapping of names starting with a string - also allow deletion of all data from a specific upload.

07-09-19

Import validation feedback can now look up by a line number rather than value

Tidying, sending xml requires "Y" not just something in the cell

Only list states with a length of 2 characters. (found states called '1' and '.99999999')

With the new 'scale' function (to handle lookups such as FX or underwriter percentage involvement)

Reimplemented filterby, "as" now works properly

03-09-19

Executes can dump debugging info if required

28-08-19

Brokasure xml scan bug fix

28-08-19

Switch on report scheduler

fixed bugs relating to languages in 'includeInParents' - now amended to 'optionalIncludeInParents' to accommodate the parameter 'optional', which will only fill the cell if the name already exists.

23-08-19

Tidying and work on the excel save to execute correctly after

Code for revised 'lookup' and 'optional'

16-08-19

Make DBCron only grab XML files it has generated - UAT and Dev share folders, need to stop them reading each other's files

Excel plug in save functionality

making the export from execute append the host name to the beginning of the file. For power BI export

has basic string functions (left, right, mid) for user choices (in [])

'standardise' (removes all but numbers and characters from strings (e.g. addresses)

02-08-19

Removes $ and £ signs from values which can be stored as numbers. Preparatory work to handle 'provisionsl'

Host prefix on power BI export

includes function 'standardise' which removes all characters except numbers and letters from string as in 'standardise("17 Broad Street",7) ->17Broad

25-07-19

Include 'Dictionary' in list of heading clause words

Various bug fixes

16-07-19

Minor plugin update. Deployment in preparation for UAT move.

11-07-19

Windows compatibility bug fixing

Excel plugin work, bug fixes for Premium

10-07-19

Work on Windows Deployment - more specifically changes to the libreoffice file conversion (fix certain xls files) and use of the log4j since under Windows Tomcat seems to deal with System.out.printlns in a different way

02-07-19

shows the choices selected by loops in the execute upload results feedback

zapped a css bug that was interfering with ZK

01-07-19

don't store value history when values are deleted because names are deleted

28-06-19-2

Bug fix on repeat sheet

28-06-19

fixed bug in permuted temporary set headings

Bug fixing schedules and adding execute

27-06-19

fixed bug in permuted temporary set headings

Export from an execute work - for BI data export

26-06-19

all headings are now checked to see if there are any user choices specified by [] to be changed to the equivalent value

DataRegionHeadings are checked to see if they have explicit attribute names to be converted to the equivalent value (e.g. `This Year`.`Yearstart` -> 2019-01-01

21-06-19

Number standardiseation bug fix (there was a problem with contract line refs)

can accept 'as' expressions in permute terms when creating temporary multi-choice sets

18-06-19

Attempts to detect an import template when there's no import model sheet

fixed provisional so as not to change 'exclusive' set elements

bug fix to stop non xml files tripping the scanning

14-06-19

Option to restore just the reports, untested. Properties for new windows servers added.

11-06-19

Move generated claim settlement files to the outbox as per Ed Broking instructions (on success message from Brokasure)

Textarea and defaults on Excel forms, first try at case insensitivity on file heading lookups

Number of names adjusted, derived from provenance after uploading the file

Altered search for a definitive header. Old logic - if no 'attributesubject' (i.e. heading with 'language' other than date defined), then look for hading with no attribute OR heading with language date.
New logic = after defining all headings, check all those with language 'date'. If those headings are not matched with a heading which 'isAttributeSubject' or has no attribute, then they become 'isAttributeSubject'

More efficient values modified count, start of work to remove typed pair, more properties for new Ed Broking servers

Work to enable executing 'set' instruction to 'set' values as well as sets.

Enabling execute and XML on form submit in Excel

31-05-19

Further Excel Controller form work - date picker and autocomplete

Work on lookup to allow provisional lookups to use the best guess, and to use the best guess when no end is specified.

Clean up xlsx files which Brokasure didn't pick up.

10-05-19

Tightened RMI concurrency code, Excel controller work to enable the new manual entry forms in plugin

09-05-19

Add download option for XML, fix build error from CSV

08-05-19

Bug fixes, updated ZSS developer license

07-05-19

! Due to cross domain session limitations old session code has been reinstated for the Excel plugin.

Fix bugs in 'bestnamematch'

03-05-19

Bug fixing, removing limit on number of xml files generated

01-05-19

! File handler leak fixed

29-04-19

Report list sort now on Category and Explanation

Further Brokasure XML work, to read data back in. Currently untested.

25-04-19

XML work to export to a directory and for the XML to reference the XLSX file by name

23-04-19

NPE bug fix

18-04-19

Instead of base 64 hashes use simple digits

15-04-19

More flexible file prefixes in XML export

15-04-19

Better xlsx file names in XML zip download

12-04-19

New file type functionality, files with a type are flagged, move with backups, and can be seen for download by normal users

03-04-19

Adjustment to how report categories are stored in backups

02-04-19

Changes to XML file name generation for Broaksure

29-03-19

xls libreoffice convert - requires libreoffice to be installed

27-03-19

'asglobal' works with 'where (' statements

better feedback on number of lines rejected

Bug fixes and better session management on the Excel plugin

12-03-19

Report Category work

07-03-19

Validation option on import templates should mean no validations run on a vanilla import

Can set report categories (though they are not read yet) and bug fix when uploading databases without templates

06-03-19

Add apache commons codec back in, XML scanning of files back from brokasure, standard user upload. Rename contextual menu Debug to Derivation.

27-02-19

Reports with the same name will overwrite, Brokasure XML export and import work

26-02-19

encode all of the json or newer versions of tomcat will complain in js tree

bug fix which will refresh the permissions even when looking up a user that's logged in previously, this needs work

21-02-19

new syntax of 'applies to'. If a single name is specified (e.g. `Contract Reference` - this is now taken to mean `Contract reference` level lowest

Tidying, bug fix to batch importer when name for attribute in composite is blank, bug fix when deleting databases, started on report based use of dictionary, Excel controller doensn't show the home menu as a linkable menu

'valueset' adjusted to ignore attribute headings, and use pre-compiled set on the dataRegionHeading if available

New message of "no data" if the file has the correct structure but is blank

18-02-19

Manually add to pending uploads

With conditional on composite values - if(condition, iftrue, iffalse)

Allow downloading of the warnings for a pending upload which can be modified and then uploaded

13-02-19

Import templates linked to databases and backups, improved progress feedback during import/validation, reject button working, concurrent modification check, broaksure XML export changes

08-02-19

attributes allow commas

tidying, Excel plugin work

07-02-19

Case insensitive choices - allow dec-18 if a list has Dec-18, latest MySQL driver, double check query names are ordered, properties for new Ed Broking windows server

SHould be improved error messages

05-02-19

Single import process work. UI improvements, zip feedback, list pending uploads based on the user's team

with new 'provisional' clause (provisional = only insert into set if not already categorised as some other element of the set)

Does not import hidden sheets

01-02-19

Pending uploads optimizeation, UI tweaks, Region size limit pushed to 5 million for big risk data summary

23-01-19

Starting work based off the Alex/Oliver meetings, temporary memory copy of a DB and revisions to the pending upload table. Old revert/commit stuff removed

21-01-19

Initial version of query validation feedback (on pending uploads)

Checks for the start of the template name, rather than the whole name

19-01-19

Considerable work on query validation, initial version

18-01-19-2

! Completed changes to make the permissions held against the session more robust

18-01-19

! Bug fix for rebuilding dev

16-01-19-2

! Bug fix on improved upload feedback

16-01-19

Includes 'fillSpecialRegions' - these are regions without row headings that will be treated as imports. Currently the save flags are now working on these regions

With routine to send mail on saving the sheet

Bug fix on uploaded files list, better feedback on headings used in imported files

Dependant on forces all exact - fix for the contract split problem

Queries executed at book level

15-01-19

Converts percentages in 'DEFAULT' to numbers

Will look for worksheets that share a first name with the imported file as 'Import Model'

Will accept that any workbook named '... import templates' is a set of import templates

Bug fixing for "applies to" calc stuff, being used again at Ed Broking

If there are no row headings does not check for changed cells

Includes 'fillSpecialRegions' - these are regions without row headings that will be treated as imports. Currently the save flags are now working on these regions

Pending upload UI work

With routine to send mail on saving the sheet

09-01-19

'len()' function in imports

Changed dateformats from dd-MM to d-m throughout

Checks the date format on composition cells

Copies clauses from context headings to next heading

UI tweaks to pending upload - mainly feedback so the user knows that the system is processing

Override values are now assumed to be in DEFAULT_DISPLAY_NAME

04-01-19

Skiplines + nofileheadings allowed in new import templates

Guess an Import Template from a file name

Various Import Template bug fixes

Provenance on a name now changes when a name's attributes or children change

Initial version of "updated" as a syntax option to be used in post import execute routines. For splits between contracts.

21-12-18-2

N/A added to pending upload params

21-12-18

Bug fixes on importing, further improvements to feedback on importing

20-12-18

The system now uses Import Templates. This is a *major* update which accounts for the gap in deployments.

Can execute multi-line 'az_execute' regions

If the az_Execute range is also called 'az_PreExecute' then the execution will happen every time.

Functions inserted - BESTVALUEMATCH, BESTNAMEMATCH, BESTNAMEVALUEMATCH - defined in Reference Manual

Will allow bracketed 'Where' statements to pass to the NameFilterFunctions if they refer to attributes

Allows offset top headings, more specifically when they're shifted right

Composite attribute syntax, various bits of code tidying

27-11-18-2

! Groovy script bug fix


27-11-18

XML named region option to export data from a report to an XML file


26-11-18

See results of importing on the uploads list

Scroll import error/feedback

! Fix groovy to work with the new uploaded file object


21-11-18

Will execute regions 'az_query<regionname>' before populating region

Removed redundant "set up file" functionality

Sorts large sets where 'from' or 'to' is specified

Refactoring parameters passed around while uploading data - intitial effect is improved feedback from importing which will be improved further

! Fixed file handler error that was crashing the server


16-11-18

NPE catch on outside case in query parsing (from/to in a list), optimiseation when resetting large children sets on a name

Fixed bug - confusion between fileName and fileSource when setting up 'DATAIMPORT'


15-11-18

! Import null pointer fix

Added 'linecells' (the number of actual cells on an import line)

Avoids filling in values where the cell count > heading count

Bug fix on report list and support for non admin user menus in the Excel plugin


13-11-18

Shows 500 recently updated files

Fixed bug - SetsImport required FileSource - not fileName

Shows the sheet name when reporting the import

! Will accept a user choice list (from UserDAO) with multiple choices separated by commas

Reports associated with no databases no longer hidden


07-11-18

Pending upload search

Splits attributes where there is a NEXTATTRIBUTE (||) symbol

New heading 'replace' which accepts the last value rather than adding all values


06-11-18

Login message and colour configurable to distinguish between systems.

Important bug fix to new import code! (it was tripped up by very large numbers)


05-11-18-2

Formatting import error messages.

Zap pending uploads when deleting a database. Logon page override configurable. Factor properties code.


05-11-18

Updated groovy import script for premium.

Handles xls files with new import routines - some recent xls files show issues that need to be addressed but no Ed Broking data.

Importing brings the names of cells imported into line with the default display name of the value found.

New poi based reading of xlsx enabled. Much faster than ZK.


01-11-18

New 'check' work (not yet completed) - basic column validation for when users mix up columns in a data file

Fixed bug where ` was deleted from start of import string

Some work on how groovy scripts are loaded

Further work on new faster POI import, may be enabled early next week

Fixed nasty bug when saving using a temporary set. Lookup on temporary sets should be by user email/logon NOT name!


31-10-18-2

Removed the ZK importer optimization, it was causing a problem with sheet update detection (snap charts and resolve formulae function)


31-10-18

Initial version of pending uploads - only visible if some files actually are there to be processed

Batch importer line exceptions now pushed into "rejected lines" rather than stopping the whole import.

Rejigging jar libraries as poi and ZK don't coexist well, more work on faster poi based import but this is still quarantined


29-10-18-2

Import throws an error if lookup not found


29-10-18

Apache POI libraries added for import optimizeation work (code currently disabled)

Better feedback on the import on whether the database was actually changed or not

File import parameter assumptions now override any value found on file. (for Ed Broking where 'certain underwriters at Lloyds' does not mean the default value (BB007620))

25-10-18

Added 'exclusive' to 'classification' when importing

Bug fix stopped numbers ending in 'F' being recognised as numbers (parseDouble recognises '17F')


24-10-18-4

Bug fix - ZK force formula check on all sheets not just the front one


24-10-18-3

Bug fix on keeping user menus when overwriting databases


24-10-18-2

Brand the audit/debug xlsx file, needs a more configurable solution later


24-10-18

Bug fix on sheet calculations that was causing save problems for Elseco

Further (still hidden) work on pending uploads


23-10-18-2

Changes condition for creating an import template from a worksheet - parameters are allowed on set up files

First successful test of a directory scan moving files and creating records in the database successfully


23-10-18

Shows audit on calculated fields

Started work on pending uploads area (currently hidden to users)

When importing removes the ' mark on excel cells that start ' and have no other '


22-10-18-3

CPU and memory report added, bug fix to keep user menus linked when loading a DB from a backup file


22-10-18-2

ZK optimiseation to put our code in their PostImporter. Should allow inserting of lines faster.

Bug fix when auditing multiple worksheets


22-10-18

Added this file!

Bug fixing resolving choices and queries - was only clearing the formula result cache when a number - clearly wrong!

Improved error messages on importing

User choices ignore az_ so if date set in one place from a dropdown as az_datechoice it will be picked up by datechoice and vice versa

Adding data to a list (column headings but no row headings) now also works going right rather than down with row headings but no column headings

When importing, fixed bug in calculating compositions where the child value is a blank string, improvements to composition dependency (resolve cells in the correct order)

Standardise dates when converting an Excel file for importing

Cap ZK rows at 5k, we should use the Excel Add In for large numbers of cells

Download database icon better


11-10-18

More URL security tightening

Improvements to 'composition' and new 'lookup' function in import

new 'lookup' function and exception catch on testing attribute as name in import

new fields for 'lookup' function

Code tidying, removed some redundant calls, no more depreciated warnings on compile, some removal of string literals, trying to get rid of some of the "todo"s. Started on the directory scanning code for Ed Broking

Ed Broking login page build version, patch files fix for deployment (auto open for Excel Javascript plugin)


08-10-18

Improved chances of maintaining user sessions across code deployment

When importing before using the plain cell value in composite calcs, looks to see if name should be calculated, and default display name used instead (relevant if an import cell's value is different to the name it resolves to)

Maintenance on url hacking security (e.g. if someone were to manually edit a database id) and removal of a few redundant controllers

Allows (ignores) error cells when converting worksheets to CSVs for importing

Improved skipping of irrelevant lines at the top of data import sheets

Added file name to import error messages

Attributes now sorted alphabetically when editing on "inspect database"

Version number in the login screen title