08-08-19

Initial version of tracking database code for Ed Broking

Allow zapping of names starting with a string - also allow deletion of all data from a specific upload.

07-08-19

Import validation feedback can now look up by a line number rather than value

Tidying, sending xml requires "Y" not just something in the cell

Only list states with a length of 2 characters. (found states called '1' and '.99999999')

With the new 'scale' function (to handle lookups such as FX or underwriter percentage involvement)

Reimplemented filterby, "as" now works properly

03-08-19

Executes can dump debugging info if required

28-08-19

Brokasure xml scan bug fix

28-08-19

Switch on report scheduler

fixed bugs relating to languages in 'includeInParents' - now amended to 'optionalIncludeInParents' to accommodate the parameter 'optional', which will only fill the cell if the name already exists.

23-08-19

Tidying and work on the excel save to execute correctly after

Code for revised 'lookup' and 'optional'

16-08-19

Make DBCron only grab XML files it has generated - UAT and Dev share folders, need to stop them reading each other's files

Excel plug in save functionality

making the export from execute append the host name to the beginning of the file. For power BI export

has basic string functions (left, right, mid) for user choices (in [])

'standardise' (removes all but numbers and characters from strings (e.g. addresses)

02-08-19

Removes $ and Â£ signs from values which can be stored as numbers. Preparatory work to handle 'provisionsl'

Host prefix on power BI export

includes function 'standardise' which removes all characters except numbers and letters from string as in 'standardise("17 Broad Street",7) ->17Broad

25-07-19

Include 'Dictionary' in list of heading clause words

Various bug fixes

16-07-19

Minor plugin update. Deployment in preparation for UAT move.

11-07-19

Windows compatibility bug fixing

Excel plugin work, bug fixes for Premium

10-07-19

Work on Windows Deployment - more specifically changes to the libreoffice file conversion (fix certain xls files) and use of the log4j since under Windows Tomcat seems to deal with System.out.printlns in a different way

02-07-19

shows the choices selected by loops in the execute upload results feedback

zapped a css bug that was interfering with ZK

01-07-19

don't store value history when values are deleted because names are deleted

28-06-19-2

Bug fix on repeat sheet

28-06-19

fixed bug in permuted temporary set headings

Bug fixing schedules and adding execute

27-06-19

fixed bug in permuted temporary set headings

Export from an execute work - for BI data export

26-06-19

all headings are now checked to see if there are any user choices specified by [] to be changed to the equivalent value

DataRegionHeadings are checked to see if they have explicit attribute names to be converted to the equivalent value (e.g. `This Year`.`Yearstart` -> 2019-01-01

21-06-19

Number standardiseation bug fix (there was a problem with contract line refs)

can accept 'as' expressions in permute terms when creating temporary multi-choice sets

18-06-19

Attempts to detect an import template when there's no import model sheet

fixed provisional so as not to change 'exclusive' set elements

bug fix to stop non xml files tripping the scanning

14-06-19

Option to restore just the reports, untested. Properties for new windows servers added.

11-06-19

Move generated claim settlement files to the outbox as per Ed Broking instructions (on success message from Brokasure)

Textarea and defaults on Excel forms, first try at case insensitivity on file heading lookups

Number of names adjusted, derived from provenance after uploading the file

Altered search for a definitive header. Old logic - if no 'attributesubject' (i.e. heading with 'language' other than date defined), then look for hading with no attribute OR heading with language date.
New logic = after defining all headings, check all those with language 'date'. If those headings are not matched with a heading which 'isAttributeSubject' or has no attribute, then they become 'isAttributeSubject'

More efficient values modified count, start of work to remove typed pair, more properties for new Ed Broking servers

Work to enable executing 'set' instruction to 'set' values as well as sets.

Enabling execute and XML on form submit in Excel

31-05-19

Further Excel Controller form work - date picker and autocomplete

Work on lookup to allow provisional lookups to use the best guess, and to use the best guess when no end is specified.

Clean up xlsx files which Brokasure didn't pick up.

10-05-19

Tightened RMI concurrency code, Excel controller work to enable the new manual entry forms in plugin

09-05-19

Add download option for XML, fix build error from CSV

08-05-19

Bug fixes, updated ZSS developer license

07-05-19

! Due to cross domain session limitations old session code has been reinstated for the Excel plugin.

Fix bugs in 'bestnamematch'

03-05-19

Bug fixing, removing limit on number of xml files generated

01-05-19

! File handler leak fixed

29-04-19

Report list sort now on Category and Explanation

Further Brokasure XML work, to read data back in. Currently untested.

25-04-19

XML work to export to a directory and for the XML to reference the XLSX file by name

23-04-19

NPE bug fix

18-04-19

Instead of base 64 hashes use simple digits

15-04-19

More flexible file prefixes in XML export

15-04-19

Better xlsx file names in XML zip download

12-04-19

New file type functionality, files with a type are flagged, move with backups, and can be seen for download by normal users

03-04-19

Adjustment to how report categories are stored in backups

02-04-19

Changes to XML file name generation for Broaksure

29-03-19

xls libreoffice convert - requires libreoffice to be installed

27-03-19

'asglobal' works with 'where (' statements

better feedback on number of lines rejected

Bug fixes and better session management on the Excel plugin

12-03-19

Report Category work

07-03-19

Validation option on import templates should mean no validations run on a vanilla import

Can set report categories (though they are not read yet) and bug fix when uploading databases without templates

06-03-19

Add apache commons codec back in, XML scanning of files back from brokasure, standard user upload. Rename contextual menu Debug to Derivation.

27-02-19

Reports with the same name will overwrite, Brokasure XML export and import work

26-02-19

encode all of the json or newer versions of tomcat will complain in js tree

bug fix which will refresh the permissions even when looking up a user that's logged in previously, this needs work

21-02-19

new syntax of 'applies to'. If a single name is specified (e.g. `Contract Reference` - this is now taken to mean `Contract reference` level lowest

Tidying, bug fix to batch importer when name for attribute in composite is blank, bug fix when deleting databases, started on report based use of dictionary, Excel controller doensn't show the home menu as a linkable menu

'valueset' adjusted to ignore attribute headings, and use pre-compiled set on the dataRegionHeading if available

New message of "no data" if the file has the correct structure but is blank

18-02-19

Manually add to pending uploads

With conditional on composite values - if(condition, iftrue, iffalse)

Allow downloading of the warnings for a pending upload which can be modified and then uploaded

13-02-19

Import templates linked to databases and backups, improved progress feedback during import/validation, reject button working, concurrent modification check, broaksure XML export changes

08-02-19

attributes allow commas

tidying, Excel plugin work

07-02-19

Case insensitive choices - allow dec-18 if a list has Dec-18, latest MySQL driver, double check query names are ordered, properties for new Ed Broking windows server

SHould be improved error messages

05-02-19

Single import process work. UI improvements, zip feedback, list pending uploads based on the user's team

with new 'provisional' clause (provisional = only insert into set if not already categorised as some other element of the set)

Does not import hidden sheets

01-02-19

Pending uploads optimizeation, UI tweaks, Region size limit pushed to 5 million for big risk data summary

23-01-19

Starting work based off the Alex/Oliver meetings, temporary memory copy of a DB and revisions to the pending upload table. Old revert/commit stuff removed

21-01-19

Initial version of query validation feedback (on pending uploads)

Checks for the start of the template name, rather than the whole name

19-01-19

Considerable work on query validation, initial version

18-01-19-2

! Completed changes to make the permissions held against the session more robust

18-01-19

! Bug fix for rebuilding dev

16-01-19-2

! Bug fix on improved upload feedback

16-01-19

Includes 'fillSpecialRegions' - these are regions without row headings that will be treated as imports. Currently the save flags are now working on these regions

With routine to send mail on saving the sheet

Bug fix on uploaded files list, better feedback on headings used in imported files

Dependant on forces all exact - fix for the contract split problem

Queries executed at book level

15-01-19

Converts percentages in 'DEFAULT' to numbers

Will look for worksheets that share a first name with the imported file as 'Import Model'

Will accept that any workbook named '... import templates' is a set of import templates

Bug fixing for "applies to" calc stuff, being used again at Ed Broking

If there are no row headings does not check for changed cells

Includes 'fillSpecialRegions' - these are regions without row headings that will be treated as imports. Currently the save flags are now working on these regions

Pending upload UI work

With routine to send mail on saving the sheet

09-01-19

'len()' function in imports

Changed dateformats from dd-MM to d-m throughout

Checks the date format on composition cells

Copies clauses from context headings to next heading

UI tweaks to pending upload - mainly feedback so the user knows that the system is processing

Override values are now assumed to be in DEFAULT_DISPLAY_NAME

04-01-19

Skiplines + nofileheadings allowed in new import templates

Guess an Import Template from a file name

Various Import Template bug fixes

Provenance on a name now changes when a name's attributes or children change

Initial version of "updated" as a syntax option to be used in post import execute routines. For splits between contracts.

21-12-18-2

N/A added to pending upload params

21-12-18

Bug fixes on importing, further improvements to feedback on importing

20-12-18

The system now uses Import Templates. This is a *major* update which accounts for the gap in deployments.

Can execute multi-line 'az_execute' regions

If the az_Execute range is also called 'az_PreExecute' then the execution will happen every time.

Functions inserted - BESTVALUEMATCH, BESTNAMEMATCH, BESTNAMEVALUEMATCH - defined in Reference Manual

Will allow bracketed 'Where' statements to pass to the NameFilterFunctions if they refer to attributes

Allows offset top headings, more specifically when they're shifted right

Composite attribute syntax, various bits of code tidying

27-11-18-2

! Groovy script bug fix


27-11-18

XML named region option to export data from a report to an XML file


26-11-18

See results of importing on the uploads list

Scroll import error/feedback

! Fix groovy to work with the new uploaded file object


21-11-18

Will execute regions 'az_query<regionname>' before populating region

Removed redundant "set up file" functionality

Sorts large sets where 'from' or 'to' is specified

Refactoring parameters passed around while uploading data - intitial effect is improved feedback from importing which will be improved further

! Fixed file handler error that was crashing the server


16-11-18

NPE catch on outside case in query parsing (from/to in a list), optimiseation when resetting large children sets on a name

Fixed bug - confusion between fileName and fileSource when setting up 'DATAIMPORT'


15-11-18

! Import null pointer fix

Added 'linecells' (the number of actual cells on an import line)

Avoids filling in values where the cell count > heading count

Bug fix on report list and support for non admin user menus in the Excel plugin


13-11-18

Shows 500 recently updated files

Fixed bug - SetsImport required FileSource - not fileName

Shows the sheet name when reporting the import

! Will accept a user choice list (from UserDAO) with multiple choices separated by commas

Reports associated with no databases no longer hidden


07-11-18

Pending upload search

Splits attributes where there is a NEXTATTRIBUTE (||) symbol

New heading 'replace' which accepts the last value rather than adding all values


06-11-18

Login message and colour configurable to distinguish between systems.

Important bug fix to new import code! (it was tripped up by very large numbers)


05-11-18-2

Formatting import error messages.

Zap pending uploads when deleting a database. Logon page override configurable. Factor properties code.


05-11-18

Updated groovy import script for premium.

Handles xls files with new import routines - some recent xls files show issues that need to be addressed but no Ed Broking data.

Importing brings the names of cells imported into line with the default display name of the value found.

New poi based reading of xlsx enabled. Much faster than ZK.


01-11-18

New 'check' work (not yet completed) - basic column validation for when users mix up columns in a data file

Fixed bug where ` was deleted from start of import string

Some work on how groovy scripts are loaded

Further work on new faster POI import, may be enabled early next week

Fixed nasty bug when saving using a temporary set. Lookup on temporary sets should be by user email/logon NOT name!


31-10-18-2

Removed the ZK importer optimization, it was causing a problem with sheet update detection (snap charts and resolve formulae function)


31-10-18

Initial version of pending uploads - only visible if some files actually are there to be processed

Batch importer line exceptions now pushed into "rejected lines" rather than stopping the whole import.

Rejigging jar libraries as poi and ZK don't coexist well, more work on faster poi based import but this is still quarantined


29-10-18-2

Import throws an error if lookup not found


29-10-18

Apache POI libraries added for import optimizeation work (code currently disabled)

Better feedback on the import on whether the database was actually changed or not

File import parameter assumptions now override any value found on file. (for Ed Broking where 'certain underwriters at Lloyds' does not mean the default value (BB007620))

25-10-18

Added 'exclusive' to 'classification' when importing

Bug fix stopped numbers ending in 'F' being recognised as numbers (parseDouble recognises '17F')


24-10-18-4

Bug fix - ZK force formula check on all sheets not just the front one


24-10-18-3

Bug fix on keeping user menus when overwriting databases


24-10-18-2

Brand the audit/debug xlsx file, needs a more configurable solution later


24-10-18

Bug fix on sheet calculations that was causing save problems for Elseco

Further (still hidden) work on pending uploads


23-10-18-2

Changes condition for creating an import template from a worksheet - parameters are allowed on set up files

First successful test of a directory scan moving files and creating records in the database successfully


23-10-18

Shows audit on calculated fields

Started work on pending uploads area (currently hidden to users)

When importing removes the ' mark on excel cells that start ' and have no other '


22-10-18-3

CPU and memory report added, bug fix to keep user menus linked when loading a DB from a backup file


22-10-18-2

ZK optimiseation to put our code in their PostImporter. Should allow inserting of lines faster.

Bug fix when auditing multiple worksheets


22-10-18

Added this file!

Bug fixing resolving choices and queries - was only clearing the formula result cache when a number - clearly wrong!

Improved error messages on importing

User choices ignore az_ so if date set in one place from a dropdown as az_datechoice it will be picked up by datechoice and vice versa

Adding data to a list (column headings but no row headings) now also works going right rather than down with row headings but no column headings

When importing, fixed bug in calculating compositions where the child value is a blank string, improvements to composition dependency (resolve cells in the correct order)

Standardise dates when converting an Excel file for importing

Cap ZK rows at 5k, we should use the Excel Add In for large numbers of cells

Download database icon better


11-10-18

More URL security tightening

Improvements to 'composition' and new 'lookup' function in import

new 'lookup' function and exception catch on testing attribute as name in import

new fields for 'lookup' function

Code tidying, removed some redundant calls, no more depreciated warnings on compile, some removal of string literals, trying to get rid of some of the "todo"s. Started on the directory scanning code for Ed Broking

Ed Broking login page build version, patch files fix for deployment (auto open for Excel Javascript plugin)


08-10-18

Improved chances of maintaining user sessions across code deployment

When importing before using the plain cell value in composite calcs, looks to see if name should be calculated, and default display name used instead (relevant if an import cell's value is different to the name it resolves to)

Maintenance on url hacking security (e.g. if someone were to manually edit a database id) and removal of a few redundant controllers

Allows (ignores) error cells when converting worksheets to CSVs for importing

Improved skipping of irrelevant lines at the top of data import sheets

Added file name to import error messages

Attributes now sorted alphabetically when editing on "inspect database"

Version number in the login screen title